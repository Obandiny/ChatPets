<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <ng-container *ngIf="authService.isLoggedIn(); else redirectToLogin">
        <header class="header">
            <div class="btn-menu-lateral">
                <button mat-icon-button matTooltip="Abrir menú" (click)="toggleMenu()">
                <mat-icon>dehaze</mat-icon>
                </button>
            </div>
            <div class="app-name">MASCOTAPP</div>
            <div class="btn-menu-login">
                <button mat-icon-button (click)="logout()">
                <mat-icon>logout</mat-icon>
                </button>
            </div>
        </header>

        <main class="main">
            <!-- De momento sin contenido principal -->
        
            <!-- Menu lateral -->
            <aside class="menu-lateral" *ngIf="isMenuOpen">
                <button mat-button (click)="toggleMenu()">Cerrar menú</button>

                <!-- Rutas comunes -->
                <div class="group-btn">
                    <a routerLink="/chat">ChatPet</a>
                    <a routerLink="/diagnostico">Diagnóstico</a>
                </div>

                <!-- Opciones de administrador -->
                <div *ngIf="rol === 'admin'" class="admin-section">
                    <h4>Admin</h4>
                    <a routerLink="/admin/usuarios">Gestión de Usuarios</a>
                    <a routerLink="/admin/blog">Gestión del Blog</a>
                    <a routerLink="/admin/graficas">Gráficas</a>
                </div>

                <!-- Historial diagnóstico -->
                <div class="group-history">
                    <h4>Historial Diagnósticos</h4>
                    <!-- HISTORIAL -->
                    <div *ngFor="let item of historialDiagnosticos" class="history-card">
                        <p>{{ item.fecha | date }}</p>
                        <p>{{ item.mascota }}</p>
                        <button mat-button (click)="verDetalle(item)">Ver</button>
                    </div>
                </div>
            </aside>
        </main>

        <footer class="footer">
            <div class="links">
                <a href="#">Política</a>
                <a href="#">Soporte</a>
                <a href="#">Contacto</a>
            </div>
        </footer>
    </ng-container>

    <ng-template #redirectToLogin>
        <p>No estás autenticado. <a routerLink="/auth/login">Iniciar sesión</a></p>
    </ng-template>
</body>
</html>

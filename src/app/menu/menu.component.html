<body>
  <div class="page-wrapper">

    <header class="header" [class.menu-open]="isMenuOpen" [class.menu-closed]="!isMenuOpen">
      <button class="btn-open-menu" aria-label="Abrir/Cerrar menú" (click)="toggleMenu()">
        <mat-icon>{{ isMenuOpen ? 'menu_open' : 'menu' }}</mat-icon>
      </button>
      <h1 class="app-name">MASCOTAPP</h1>
      <div class="bienvenida">
        {{ mensajeBienvenida }}
      </div>
      <button class="btn-logout" aria-label="Cerrar sesión" (click)="logout()">
        <mat-icon class="logout" matTooltip="Cerrar sesión">logout</mat-icon>
      </button>
    </header>

    <nav class="menu-lateral" *ngIf="isMenuOpen" role="navigation" aria-label="Menú lateral">
      <button class="btn-close-menu" (click)="toggleMenu()">Cerrar Menú</button>

      <div class="group-btn">
        <a [routerLink]="['/menu']" routerLinkActive="active">Inicio</a>

        <button class="submenu-toggle" (click)="toggleSubmenu()" *ngIf="rol === 'usuario'">
          Diagnosticos
          <mat-icon>{{ submenuAbierto ? 'expand_less' : 'expand_more' }}</mat-icon>
        </button>
        
        <div *ngIf="submenuAbierto" class="submenu">
          <a [routerLink]="['/registrar-mascota']">Registrar mascota</a>
          <a 
            [class.disabled-link]="!mascotaRegistrada"
            [attr.aria-disabled]="!mascotaRegistrada"
            (click)="!mascotaRegistrada ? $event.preventDefault() : null"
            class="boton-principal"
            (click)="toggleSubmenuMascotas()"
            >Ingresar Diagnostico
             <mat-icon>{{ submenuMascotasAbierto ? 'expand_less' : 'expand_more' }}</mat-icon> 
          </a>
        </div>

        <div *ngIf="submenuMascotasAbierto" class="mascotas-grid">
          <button class="card-mascota" *ngFor="let mascota of mascotas" (click)="irADiagnostico(mascota.id)"> 
            {{ mascota.nombre }}
          </button>
        </div>

        <a routerLink="/perfil" routerLinkActive="active">Perfil</a>
        <button class="submenu-toggle" (click)="toggleSubmenuAdmin()">
          Administrar
          <mat-icon>{{ submenuAbiertoAdmin ? 'expand_less' : 'expand_more' }}</mat-icon>
        </button>

        <div *ngIf="submenuAbiertoAdmin" class="submenu">
          <!-- *ngIf="rol === 'admin'" -->
          <a [routerLink]="['/admin/table-usuarios']" routerLinkActive="active" >Usuarios</a>
          <a [routerLink]="['/admin/table-sintomas']" routerLinkActive="active">Relaciones</a>
          <a [routerLink]="['/admin/table-mascotas']" routerLinkActive="active">Mascotas</a>
        </div>

      </div>

      <section aria-label="Historial de diagnósticos">
        <h2>Historial</h2>
        <div *ngFor="let card of historial" class="card">
          <img [src]="card.imagen || 'default.jpg'"  alt="Mascota" class="imagen-mascota">
          <div class="info">
            <h4>{{ card.nombre_mascota }}</h4>
            <p>{{ card.fecha | date:'short' }}</p>
            <button (click)="verChat(card.id)">Abrir</button>
            <button (click)="eliminar(card.id)">Eliminar</button>
          </div>
        </div>
      </section>
    </nav>

    <main [class.menu-open]="isMenuOpen" [class.menu-closed]="!isMenuOpen" class="main">
      <h2 class="section-title section-title-white">Consejos para el Cuidado de tu Mascota</h2>

      <section class="carousel-container" aria-label="Carrusel de tips para mascotas">
        <div class="carousel" [style.transform]="getTransform()">
          <article class="carousel-item" *ngFor="let tip of tips; let i = index" [attr.aria-hidden]="currentTipIndex !== i">
            <h3>{{ tip.titulo }}</h3>
            <p>{{ tip.descripcion }}</p>
          </article>
        </div>

        <button class="carousel-control prev" aria-label="Tip anterior" (click)="prevTip()">
          <mat-icon>chevron_left</mat-icon>
        </button>
        <button class="carousel-control next" aria-label="Siguiente tip" (click)="nextTip()">
          <mat-icon>chevron_right</mat-icon>
        </button>
      </section>
    </main>

    <footer class="footer" [class.menu-open]="isMenuOpen" [class.menu-closed]="!isMenuOpen">
      <div class="footer-content">
        <div class="footer-info">
          <p><strong>Horarios de atención:</strong> Lunes a Viernes, 8:00 a.m. - 5:00 p.m.</p>
          <p>© 2025 MASCOTAPP. Todos los derechos reservados.</p>
        </div>
        <!-- <div class="footer-social">
          <a href="https://facebook.com" target="_blank" aria-label="Facebook">
            <img src="assets/facebook-icon.svg" alt="Facebook" />
          </a>
          <a href="https://instagram.com" target="_blank" aria-label="Instagram">
            <img src="assets/instagram-icon.svg" alt="Instagram" />
          </a>
          <a href="https://twitter.com" target="_blank" aria-label="Twitter">
            <img src="assets/twitter-icon.svg" alt="Twitter" />
          </a>
        </div> -->
      </div>
    </footer>

  </div>
</body>

<body>
  <div class="page-wrapper">

    <header class="header" [class.menu-open]="isMenuOpen" [class.menu-closed]="!isMenuOpen">
      <button class="btn-open-menu" aria-label="Abrir/Cerrar men煤" (click)="toggleMenu()" matTooltip="Abrir menu">
        <mat-icon>{{ isMenuOpen ? 'menu_open' : 'menu' }}</mat-icon>
      </button>
      <h1 class="app-name">MASCOTAPP</h1>
      <div class="bienvenida">
        {{ mensajeBienvenida }}
      </div>
      <button class="btn-logout" aria-label="Cerrar sesi贸n" (click)="logout()">
        <mat-icon class="logout" matTooltip="Cerrar sesi贸n">logout</mat-icon>
      </button>
    </header>

    <nav class="menu-lateral" *ngIf="isMenuOpen" role="navigation" aria-label="Men煤 lateral">
      <!-- <button class="btn-close-menu" (click)="toggleMenu()">Cerrar Men煤</button> -->

      <div class="group-btn">
        <a [routerLink]="['/menu']" routerLinkActive="active">Inicio</a>
        <a [routerLink]="['/chatbot']" routerLinkActive="active">Lista de Diagnosticos</a>

        <button class="submenu-toggle" (click)="toggleSubmenu()" *ngIf="rol === 'usuario'">
          Diagnosticos
          <mat-icon>{{ submenuAbierto ? 'expand_less' : 'expand_more' }}</mat-icon>
        </button>
        
        <div *ngIf="submenuAbierto" class="submenu">
          <a [routerLink]="['/registrar-mascota']">Registrar mascota</a>
          <button 
            class="submenu-toggle" 
            [disabled]="!mascotaRegistrada"
            (click)="toggleSubmenuMascotas()"
            >
            Ingresar Diagn贸stico
            <mat-icon>{{ submenuMascotasAbierto ? 'expand_less' : 'expand_more' }}</mat-icon>
          </button>
        </div>

        <div *ngIf="submenuMascotasAbierto" class="mascotas-columna">
          <button class="mascota-btn" *ngFor="let mascota of mascotas" (click)="irADiagnostico(mascota.id)">
            {{ mascota.nombre }}
            <button><mat-icon>delete</mat-icon></button>
          </button>
        </div>

        <a routerLink="/perfil" routerLinkActive="active">Perfil</a>
        <button class="submenu-toggle" (click)="toggleSubmenuAdmin()" *ngIf="rol === 'admin'">
          Administrar
          <mat-icon>{{ submenuAbiertoAdmin ? 'expand_less' : 'expand_more' }}</mat-icon>
        </button>

        <div *ngIf="submenuAbiertoAdmin" class="submenu">
          <a [routerLink]="['/admin/table-usuarios']" routerLinkActive="active">Usuarios</a>
          <a [routerLink]="['/admin/table-sintomas']" routerLinkActive="active">Sintomas</a>
          <a [routerLink]="['/admin/table-mascotas']" routerLinkActive="active">Mascotas</a>
        </div>

        <!-- <button class="subirExcel" (click)="subirExcel()">
          Subir Datos
        </button> -->

      </div>

      <section aria-label="Historial de diagn贸sticos">
        <h2>Historial</h2>
        <div class="card-container">
          <div *ngFor="let card of historial" class="historial-card">
            <img [src]="card.imagen ? card.imagen : 'assets/image/dog.png'" alt="Mascota" class="imagen-mascota">
            <div class="info">
              <h4>{{ card.nombre_mascota }}</h4>
              <p>{{ card.fecha | date:'short' }}</p>
              <div class="acciones">
                <button (click)="verChat(card.id)"><mat-icon>pets</mat-icon></button>
                <button class="icono-borrar" (click)="eliminar(card.id)"><mat-icon>delete</mat-icon></button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </nav>

    <main [class.menu-open]="isMenuOpen" [class.menu-closed]="!isMenuOpen" class="main">
      <h2 class="section-title section-title-white">NOTICIAS DE SALUD ANIMAL</h2>

      <!-- <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-semibold">Noticias recientes</h2>
        <button mat-stroked-button color="primary" (click)="cargarNoticias()">
           Refrescar
        </button>
      </div> -->

      <div class="noticias-grid">
        <mat-card *ngFor="let noticia of noticias" class="noticia-card">
          <img mat-card-image *ngIf="noticia.imagen" [src]="noticia.imagen" alt="Noticia" />
          <mat-card-title class="titulo-noticia">{{ noticia.titulo }}</mat-card-title>
          <mat-card-subtitle class="subtitulo-noticia">{{ noticia.fuente || 'Fuente desconocida' }} - {{ noticia.fecha | date:'short' }}</mat-card-subtitle>
          <mat-card-content class="descripcion">
            <p>{{ noticia.descripcion || 'Sin descripci贸n disponible.' }}</p>
          </mat-card-content>
          <mat-card-actions class="accion">
            <a mat-button color="primary" [href]="noticia.url" target="_blank">Leer mas</a>
          </mat-card-actions>
        </mat-card>
      </div>

      <div class="boton-cargar-wrapper" *ngIf="mostrarBoton">
        <button mat-raised-button color="primary" (click)="cargarNoticias()">
          Cargar m谩s noticias
        </button>
      </div>

      <!-- <section class="carousel-container" aria-label="Carrusel de tips para mascotas">
        <div class="carousel" [style.transform]="getTransform()">
          <article class="carousel-item" *ngFor="let tip of tips; let i = index" [attr.aria-hidden]="currentTipIndex !== i">
            <h3>{{ tip.titulo }}</h3>
            <p>{{ tip.descripcion }}</p>
          </article>
        </div>

        <button class="carousel-control prev" aria-label="Tip anterior" (click)="prevTip()">
          <mat-icon>chevron_left</mat-icon>
        </button>
        <button class="carousel-control next" aria-label="Siguiente tip" (click)="nextTip()">
          <mat-icon>chevron_right</mat-icon>
        </button>
      </section> -->

    </main>

    <footer class="footer" [class.menu-open]="isMenuOpen" [class.menu-closed]="!isMenuOpen">
      <div class="footer-content">
        <div class="footer-info">
          <p><strong>Horarios de atenci贸n:</strong> Lunes a Viernes, 8:00 a.m. - 5:00 p.m.</p>
          <p>漏 2025 MASCOTAPP. Todos los derechos reservados.</p>
        </div>
        <!-- <div class="footer-social">
          <a href="https://facebook.com" target="_blank" aria-label="Facebook">
            <img src="assets/facebook-icon.svg" alt="Facebook" />
          </a>
          <a href="https://instagram.com" target="_blank" aria-label="Instagram">
            <img src="assets/instagram-icon.svg" alt="Instagram" />
          </a>
          <a href="https://twitter.com" target="_blank" aria-label="Twitter">
            <img src="assets/twitter-icon.svg" alt="Twitter" />
          </a>
        </div> -->
      </div>
    </footer>
  </div>
</body>
